import{d as createAstro,c as createComponent,a as renderTemplate,h as defineScriptVars,e as addAttribute,m as maybeRenderHead,r as renderComponent,F as Fragment,g as renderTransition,f as renderScript,i as renderHead,j as renderSlot}from"./astro/server.js";import{m as moreLocales,d as defaultLocale,a as allLocales,t as themeConfig}from"./config.js";import{u as ui}from"./ui.js";import{k as katexCSS}from"./_about_.b9593cd8.js";function getLangFromPath(e){return moreLocales.find((t=>e.startsWith(`/${t}/`)))||defaultLocale}function getNextGlobalLang(e){const t=allLocales.indexOf(e);if(-1===t)return defaultLocale;const a=(t+1)%allLocales.length;return allLocales[a]}function cleanPath(e){return e.replace(/^\/|\/$/g,"")}function isHomePage(e){const t=cleanPath(e);return""===t||moreLocales.includes(t)}function isPostPage(e){const t=cleanPath(e);return t.startsWith("posts")||moreLocales.some((e=>t.startsWith(`${e}/posts`)))}function isTagPage(e){const t=cleanPath(e);return t.startsWith("tags")||moreLocales.some((e=>t.startsWith(`${e}/tags`)))}function isAboutPage(e){const t=cleanPath(e);return t.startsWith("about")||moreLocales.some((e=>t.startsWith(`${e}/about`)))}function getPageInfo(e){const t=getLangFromPath(e);return{currentLang:t,isHome:isHomePage(e),isPost:isPostPage(e),isTag:isTagPage(e),isAbout:isAboutPage(e),getLocalizedPath:e=>getLocalizedPath(e,t)}}function getTagPath(e,t){return t===defaultLocale?`/tags/${e}/`:`/${t}/tags/${e}/`}function getLocalizedPath(e,t){const a=cleanPath(e);return""===a?t===defaultLocale?"/":`/${t}/`:t===defaultLocale?`/${a}/`:`/${t}/${a}/`}function buildNextLangPath(e,t,a){if("/"===e)return a===defaultLocale?"/":`/${a}/`;const r=a===defaultLocale?e.replace(`/${t}`,"")||"/":t===defaultLocale?`/${a}${e}`:e.replace(`/${t}`,`/${a}`);return r.endsWith("/")?r:`${r}/`}function getNextGlobalLangPath(e){const t=getLangFromPath(e);return buildNextLangPath(e,t,getNextGlobalLang(t))}function getNextSupportedLangPath(e,t){if(!t.length)return getNextGlobalLangPath(e);const a=new Map([defaultLocale,...moreLocales].map(((e,t)=>[e,t]))),r=[...t].sort(((e,t)=>a.get(e)-a.get(t))),n=getLangFromPath(e),o=r.indexOf(n);return buildNextLangPath(e,n,r[(o+1)%r.length])}var _a$1,__freeze$1=Object.freeze,__defProp$1=Object.defineProperty,__template$1=(e,t)=>__freeze$1(__defProp$1(e,"raw",{value:__freeze$1(e.slice())}));const $$Astro$6=createAstro("https://xushuhui.github.io"),$$Button=createComponent(((e,t,a)=>{const r=e.createAstro($$Astro$6,t,a);r.self=$$Button;const{light:{background:n},dark:{background:o}}=themeConfig.color,{supportedLangs:i}=r.props,s=r.url.pathname,l=isPostPage(s),c=isTagPage(s),m=moreLocales.length>0,d=l||c&&i.length>0?getNextSupportedLangPath(s,i):getNextGlobalLangPath(s);return renderTemplate(_a$1||(_a$1=__template$1(["","<div","> \x3c!-- Language Switcher --\x3e ",' \x3c!-- Theme Toggle --\x3e <button aria-label="Switch light/dark theme" class="button-theme-toggle aspect-square w-4.2 c-secondary active:scale-90 hover:c-primary"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" fill="currentColor"> <path d="M12 1C5.9 1 1 5.9 1 12s4.9 11 11 11 11-4.9 11-11S18.1 1 12 1m0 20c-5.8 0-10.5-4-10.5-9S6.2 3 12 3s10.5 4 10.5 9-4.7 9-10.5 9"></path> </svg> </button> </div> \x3c!-- Theme Toggle Script >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> --\x3e <script>(function(){',"\n// Update theme\nfunction updateTheme() {\n  // Toggle website theme\n  document.documentElement.classList.toggle('dark')\n\n  // Get current theme\n  const isDark = document.documentElement.classList.contains('dark')\n  // Update meta theme color\n  const metaThemeColor = document.querySelector('meta[name=\"theme-color\"]')\n  if (metaThemeColor) {\n    metaThemeColor.setAttribute('content', isDark ? darkMode : lightMode)\n  }\n\n  // Update theme configuration in local storage\n  localStorage.setItem('theme', isDark ? 'dark' : 'light')\n  document.dispatchEvent(new Event('theme-changed'))\n}\n\n// Bind click event to the button\nfunction setupThemeToggle() {\n  // Locate theme toggle button\n  const themeToggleButtons = document.querySelectorAll('.button-theme-toggle')\n  // Add click listener to each button\n  themeToggleButtons.forEach((button) => {\n    button.addEventListener('click', () => {\n      // If browser doesn't support View Transitions API, update theme directly\n      if (!document.startViewTransition) {\n        updateTheme()\n        return\n      }\n\n      // Temporarily add markers during animation to implement view transition and disable CSS transitions\n      document.documentElement.style.setProperty('view-transition-name', 'theme-transition')\n      document.documentElement.setAttribute('data-theme-transition', '')\n\n      // If browser supports View Transitions API, use it to update theme\n      const themeTransition = document.startViewTransition(updateTheme)\n      // Remove markers after animation\n      themeTransition.finished.then(() => {\n        document.documentElement.style.removeProperty('view-transition-name')\n        document.documentElement.removeAttribute('data-theme-transition')\n      })\n    })\n  })\n}\n\n// Initialize click event (on first load or page transition)\nsetupThemeToggle()\ndocument.addEventListener('astro:after-swap', setupThemeToggle)\n})();<\/script>"])),maybeRenderHead(),addAttribute(["absolute flex gap-6 top-14.6 right-7.25vw min-[823px]:max-[1024px]:right-[calc(50vw-22rem)]","[@supports(-webkit-touch-callout:none)]:top-13.6","lg:fixed lg:w-14rem lg:top-auto lg:bottom-47 lg:right-[max(5.625rem,calc(50vw-34.375rem))]"],"class:list"),m&&renderTemplate`<a${addAttribute(d,"href")} class="aspect-square w-4 c-secondary active:scale-90 hover:c-primary" aria-label="Switch website language"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" class="h-full w-full" fill="currentColor"> <path d="M19.1 21 12.4 2h-1.2L4.6 21l-2.5.2v.8h6.3v-.8L5.6 21l2-5.9h7.5l2 5.9-3.3.2v.8h8.1v-.8zM7.9 14.3l3.4-10.1 3.5 10.1z"></path> </svg> </a>`,defineScriptVars({lightMode:n,darkMode:o}))}),"/Users/fm/www/astro-theme-retypeset/src/components/Button.astro",void 0),$$Astro$5=createAstro("https://xushuhui.github.io"),$$Footer=createComponent(((e,t,a)=>{const r=e.createAstro($$Astro$5,t,a);r.self=$$Footer;const{author:n}=themeConfig.site,{links:o,startYear:i}=themeConfig.footer,s=(new Date).getFullYear(),l=Number(i)===s?i:`${i}-${s}`,c=getLangFromPath(r.url.pathname),m=o.map((e=>"RSS"===e.name?{...e,url:c===defaultLocale?e.url:`/${c}${e.url}`}:e));return renderTemplate`${maybeRenderHead()}<footer class="text-3 leading-4.75 font-navbar lg:text-3.5" lg="uno-desktop-column bottom-20"> <p> ${m.map(((t,a)=>renderTemplate`${renderComponent(e,"Fragment",Fragment,{},{default:e=>renderTemplate` <a class="transition-colors hover:c-primary"${addAttribute(t.url,"href")}> ${t.name} </a> ${a<m.length-1&&" / "}`})}`))} </p> <p>
Powered by <a class="transition-colors hover:c-primary" href="https://astro.build/">Astro</a> and <a class="transition-colors hover:c-primary" href="https://github.com/radishzzz/astro-theme-retypeset">Retypeset</a> </p> <p>
Â© ${l} ${n} </p> </footer>`}),"/Users/fm/www/astro-theme-retypeset/src/components/Footer.astro",void 0),$$Astro$4=createAstro("https://xushuhui.github.io"),$$Header=createComponent(((e,t,a)=>{const r=e.createAstro($$Astro$4,t,a);r.self=$$Header;const{currentLang:n,getLocalizedPath:o,isPost:i}=getPageInfo(r.url.pathname),{titleGap:s}=themeConfig.global,l=ui[n],c=l.title,m=l.subtitle,d={1:"mb-0.9",2:"mb-1.8",3:"mb-2.7"}[s],u={1:"mb-1.9 lg:mb-0.9",2:"mb-2.8 lg:mb-1.8",3:"mb-3.7 lg:mb-2.7"}[s],p=i?"h2":"h1",g=i?"div":"h2";return renderTemplate`${maybeRenderHead()}<header${addAttribute([i?"mb-10.8":"mb-10.5","lg:uno-desktop-column lg:top-20"],"class:list")}> ${renderComponent(e,"TitleTag",p,{"class:list":[i?`${u} mt-3.2 text-5.375 c-secondary lg:mt-0 lg:text-9 lg:c-primary`:`${d} text-8 w-75% c-primary lg:text-9 lg:w-full`,"font-bold font-title"]},{default:e=>renderTemplate`  <div class="box-content inline-block pr-1" data-disable-transition-on-theme${addAttribute(renderTransition(e,"wif6pdce","",`site-title-${n}`),"data-astro-transition-scope")}> <a id="site-title-link"${addAttribute(o("/"),"href")}> ${c} </a> </div> `})} ${m&&renderTemplate`${renderComponent(e,"SubtitleTag",g,{"class:list":[i?"opacity-0 lg:opacity-100":"w-75% lg:w-full","c-secondary font-navbar text-3.5 lg:text-4"],"aria-hidden":i},{default:e=>renderTemplate`${m}`})}`} </header>`}),"/Users/fm/www/astro-theme-retypeset/src/components/Header.astro","self"),$$Astro$3=createAstro("https://xushuhui.github.io"),$$Navbar=createComponent(((e,t,a)=>{const r=e.createAstro($$Astro$3,t,a);r.self=$$Navbar;const{currentLang:n,isHome:o,isPost:i,isTag:s,isAbout:l,getLocalizedPath:c}=getPageInfo(r.url.pathname),m=ui[n],d=o||i,u=s,p=l;function g(e){return e?"font-bold c-primary":"hover:c-primary hover:font-bold transition-all"}const h=[{href:"/",label:m.posts,className:g(d)},{href:"/tags/",label:m.tags,className:g(u)},{href:"/about/",label:m.about,className:g(p)}];return renderTemplate`${maybeRenderHead()}<nav aria-label="Site Navigation"${addAttribute([i?"hidden lg:block":"","mb-10.5 text-3.6 font-semibold leading-8.75 font-navbar","lg:uno-desktop-column lg:text-4 lg:leading-9.72 lg:bottom-50"],"class:list")}> <ul> ${h.map((e=>renderTemplate`<li> <a${addAttribute(c(e.href),"href")}${addAttribute(e.className,"class")}> ${e.label} </a> </li>`))} </ul> </nav>`}),"/Users/fm/www/astro-theme-retypeset/src/components/Navbar.astro",void 0),$$Scrollbar=createComponent(((e,t,a)=>renderTemplate`${renderScript(e,"/Users/fm/www/astro-theme-retypeset/src/components/Widgets/Scrollbar.astro?astro&type=script&index=0&lang.ts")} `),"/Users/fm/www/astro-theme-retypeset/src/components/Widgets/Scrollbar.astro",void 0),$$Astro$2=createAstro("https://xushuhui.github.io"),$$ClientRouter=createComponent(((e,t,a)=>{const r=e.createAstro($$Astro$2,t,a);r.self=$$ClientRouter;const{fallback:n="animate"}=r.props;return renderTemplate`<meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback"${addAttribute(n,"content")}>${renderScript(e,"/Users/fm/www/astro-theme-retypeset/node_modules/.pnpm/astro@5.6.1_@types+node@22.14.1_jiti@2.4.2_lightningcss@1.29.3_rollup@4.40.0_terser@5.39.0_typescript@5.8.3_yaml@2.7.1/node_modules/astro/components/ClientRouter.astro?astro&type=script&index=0&lang.ts")}`}),"/Users/fm/www/astro-theme-retypeset/node_modules/.pnpm/astro@5.6.1_@types+node@22.14.1_jiti@2.4.2_lightningcss@1.29.3_rollup@4.40.0_terser@5.39.0_typescript@5.8.3_yaml@2.7.1/node_modules/astro/components/ClientRouter.astro",void 0);var _a,_b,_c,__freeze=Object.freeze,__defProp=Object.defineProperty,__template=(e,t)=>__freeze(__defProp(e,"raw",{value:__freeze(e.slice())}));const $$Astro$1=createAstro("https://xushuhui.github.io"),$$Head=createComponent(((e,t,a)=>{const r=e.createAstro($$Astro$1,t,a);r.self=$$Head;const{postTitle:n,postDescription:o,postSlug:i}=r.props,{currentLang:s}=getPageInfo(r.url.pathname),l=ui[s],c=s===defaultLocale?"":`${s}/`,{title:m,author:d,url:u,favicon:p}=themeConfig.site,{light:{background:g},dark:{background:h}}=themeConfig.color,{verification:f={},twitterID:$="",googleAnalyticsID:b="",umamiAnalyticsID:w="",apiflashKey:y=""}=themeConfig.seo??{},{google:A="",bing:v="",yandex:T="",baidu:x=""}=f,{commentURL:L="",imageHostURL:k="",customGoogleAnalyticsJS:_="",customUmamiAnalyticsJS:P=""}=themeConfig.preload,C=g,S=l.title,z=l.subtitle,D=l.description,F=n?`${n} | ${S}`:`${S} - ${z}`,H=o||D,I=i?`${u}/og/${i}.png`:y?`https://api.apiflash.com/v1/urltoimage?access_key=${y}&url=${u}/${c}&format=png&width=1500&height=788&ttl=86400&wait_until=network_idle&no_tracking=true`:`https://api.apiflash.com/v1/urltoimage?access_key=02a837b6188f4ba0a7fd9fbeff03a83e&url=https://retypeset.radishzz.cc/${c}&format=png&width=1500&height=788&ttl=172800&wait_until=network_idle&no_tracking=true`;return renderTemplate(_c||(_c=__template(['<head>\x3c!-- Basic info --\x3e<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">',"","","<title>",'</title><meta name="description"','><meta name="author"','><meta name="generator"','><meta name="theme-color"','>\x3c!-- Preload --\x3e<link rel="preload" href="/font/Snell-Black.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="/font/EarlySummer-Subset.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="/font/Snell-Bold.woff2" as="font" type="font/woff2" crossorigin>',"","","","",'<link rel="alternate" href="/rss.xml" type="application/rss+xml" title="RSS Feed"><link rel="alternate" href="/atom.xml" type="application/atom+xml" title="Atom Feed"><link rel="sitemap" href="/sitemap-index.xml"><link rel="canonical"',">\x3c!-- i18n hreflang generate --\x3e",'\x3c!-- Facebook Open Graph --\x3e<meta property="og:type"','><meta property="og:site_name"','><meta property="og:title"','><meta property="og:description"','><meta property="og:url"','><meta property="og:image"','><meta property="og:logo"','>\x3c!-- Twitter Card --\x3e<meta name="twitter:card" content="summary_large_image">',"",'<meta name="twitter:title"','><meta name="twitter:description"','><meta name="twitter:image"',">\x3c!-- Site Verification --\x3e","","","","\x3c!-- Global View Transition --\x3e","\x3c!-- Theme Toggle --\x3e<script>(function(){","\n// Check if current theme is dark mode\n// Priority: Local storage theme > Default theme > System preference\nfunction isCurrentDark() {\n  const currentTheme = localStorage.getItem('theme')\n  if (currentTheme)\n    return currentTheme === 'dark'\n  if (defaultMode === 'light')\n    return false\n  if (defaultMode === 'dark')\n    return true\n  return window.matchMedia('(prefers-color-scheme: dark)').matches\n}\n\n// Initialize theme\nfunction initTheme(doc = document) {\n  const isDark = isCurrentDark()\n  doc.documentElement.classList.toggle('dark', isDark)\n  const metaTheme = doc.querySelector('meta[name=\"theme-color\"]')\n  if (metaTheme) {\n    metaTheme.setAttribute('content', isDark ? darkMode : lightMode)\n  }\n}\n\n// Function 1: Initialize theme on first load\ninitTheme()\n\n// Function 2: Update theme before page transition to prevent flashing\ndocument.addEventListener('astro:before-swap', ({ newDocument }) => {\n  initTheme(newDocument)\n})\n\n// Function 3: listen to system theme changes in real-time\nwindow\n  .matchMedia('(prefers-color-scheme: dark)')\n  .addEventListener('change', ({ matches: isDark }) => {\n    localStorage.setItem('theme', isDark ? 'dark' : 'light')\n    initTheme()\n    document.dispatchEvent(new Event('theme-changed'))\n  })\n})();<\/script>\x3c!-- Google Analytics --\x3e","\x3c!-- Umami Analytics --\x3e","","</head>"])),p.toLowerCase().endsWith(".svg")&&renderTemplate`<link rel="icon" type="image/svg+xml"${addAttribute(p,"href")}>`,p.toLowerCase().endsWith(".png")&&renderTemplate`<link rel="icon" type="image/png"${addAttribute(p,"href")}>`,p.toLowerCase().endsWith(".ico")&&renderTemplate`<link rel="icon" type="image/x-icon"${addAttribute(p,"href")}>`,F,addAttribute(H,"content"),addAttribute(d,"content"),addAttribute(r.generator,"content"),addAttribute(C,"content"),renderTemplate`<link rel="stylesheet"${addAttribute(katexCSS,"href")}>`,L&&renderTemplate`<link rel="preconnect"${addAttribute(L,"href")} crossorigin>`,L&&renderTemplate`<link rel="dns-prefetch"${addAttribute(L,"href")}>`,k&&renderTemplate`<link rel="preconnect"${addAttribute(k,"href")} crossorigin>`,k&&renderTemplate`<link rel="dns-prefetch"${addAttribute(k,"href")}>`,addAttribute(r.url,"href"),allLocales.map((e=>renderTemplate`<link rel="alternate"${addAttribute(`${u}${e===defaultLocale?"":`/${e}/`}`,"href")}${addAttribute("zh-tw"===e?"zh-TW":e,"hreflang")}>`)),addAttribute(n?"article":"website","content"),addAttribute(m,"content"),addAttribute(F,"content"),addAttribute(H,"content"),addAttribute(r.url,"content"),addAttribute(I,"content"),addAttribute(p,"content"),$&&renderTemplate`<meta name="twitter:site"${addAttribute($,"content")}>`,$&&renderTemplate`<meta name="twitter:creator"${addAttribute($,"content")}>`,addAttribute(F,"content"),addAttribute(H,"content"),addAttribute(I,"content"),A&&renderTemplate`<meta name="google-site-verification"${addAttribute(A,"content")}>`,v&&renderTemplate`<meta name="msvalidate.01"${addAttribute(v,"content")}>`,T&&renderTemplate`<meta name="yandex-verification"${addAttribute(T,"content")}>`,x&&renderTemplate`<meta name="baidu-site-verification"${addAttribute(x,"content")}>`,renderComponent(e,"ClientRouter",$$ClientRouter,{fallback:"none"}),defineScriptVars({defaultMode:themeConfig.color.mode,lightMode:g,darkMode:h}),b&&renderTemplate`${renderComponent(e,"Fragment",Fragment,{},{default:e=>renderTemplate(_a||(_a=__template(['<script type="text/partytown"','><\/script><script type="text/partytown">(function(){',"\n      window.dataLayer = window.dataLayer || []\n      function gtag(...args) {\n        dataLayer.push(args)\n      }\n      gtag('js', new Date())\n\n      if (customGoogleAnalyticsJS) {\n        gtag('config', googleAnalyticsID, {\n          transport_url: new URL(customGoogleAnalyticsJS).origin,\n        })\n      }\n      else {\n        gtag('config', googleAnalyticsID)\n      }\n    })();<\/script>"])),addAttribute(_||`https://www.googletagmanager.com/gtag/js?id=${b}`,"src"),defineScriptVars({googleAnalyticsID:b,customGoogleAnalyticsJS:_}))})}`,w&&renderTemplate(_b||(_b=__template(['<script type="text/partytown" crossorigin="anonymous"',"",' data-cache="true"><\/script>'])),addAttribute(w,"data-website-id"),addAttribute(P||"https://cloud.umami.is/script.js","src")),renderHead())}),"/Users/fm/www/astro-theme-retypeset/src/layouts/Head.astro",void 0),$$Astro=createAstro("https://xushuhui.github.io"),$$Layout=createComponent(((e,t,a)=>{const r=e.createAstro($$Astro,t,a);r.self=$$Layout;const{postTitle:n,postDescription:o,postSlug:i,supportedLangs:s=[]}=r.props,{isPost:l}=getPageInfo(r.url.pathname),c=l&&themeConfig.comment?.enabled?"mb-10":"mb-12";return renderTemplate`<html${addAttribute(r.currentLocale,"lang")}${addAttribute(["font-sans",{"scroll-smooth":l}],"class:list")} data-overlayscrollbars-initialize> ${renderComponent(e,"Head",$$Head,{postTitle:n,postDescription:o,postSlug:i})}${maybeRenderHead()}<body data-overlayscrollbars-initialize> <div class="mx-auto max-w-205.848 min-h-vh w-full min-h-dvh" p="x-[min(7.25vw,3.731rem)] y-9" lg="p-0 min-h-full max-w-[min(calc(75vw-16rem),44rem)] mx-[max(5.625rem,calc(50vw-34.375rem))] my-20"> ${renderComponent(e,"Header",$$Header,{})} ${renderComponent(e,"Navbar",$$Navbar,{})} <main${addAttribute(c,"class")}> ${renderSlot(e,a.default)} </main> ${renderComponent(e,"Footer",$$Footer,{})} </div> ${renderComponent(e,"Scrollbar",$$Scrollbar,{})} ${renderComponent(e,"Button",$$Button,{supportedLangs:s})} </body></html>`}),"/Users/fm/www/astro-theme-retypeset/src/layouts/Layout.astro",void 0);export{$$Layout as $,getTagPath as a,isPostPage as b,getPageInfo as g,isTagPage as i};